---
import { getCollection } from 'astro:content';
import Section from '../shared/Section.astro';
import PostCard from '../blog/PostCard.astro';

const posts = (await getCollection('blog'))
  .sort((a, b) => new Date(b.data.date).getTime() - new Date(a.data.date).getTime())
  .slice(0, 3);
---

{posts.length > 0 && (
  <Section bg="secondary">
    <div class="text-center mb-12 reveal">
      <h2 class="font-(family-name:--font-heading) text-3xl sm:text-4xl font-bold text-(--color-text-primary) mb-4">
        Latest from the Blog
      </h2>
      <p class="text-(--color-text-secondary) text-lg max-w-2xl mx-auto">
        Tech tips, repair guides, and news from the workshop.
      </p>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
      {posts.map((post, i) => (
        <div class={`reveal reveal-delay-${i + 1}`}>
          <PostCard post={post} />
        </div>
      ))}
    </div>

    <div class="text-center mt-8 reveal">
      <a href="/blog" class="text-(--color-brand) hover:text-(--color-brand-hover) font-semibold transition-colors">
        View All Posts &rarr;
      </a>
    </div>
  </Section>
)}
